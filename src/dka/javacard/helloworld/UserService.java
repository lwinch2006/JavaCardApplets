package dka.javacard.helloworld;

import javacard.framework.APDU;
import javacard.framework.ISO7816;
import javacard.framework.ISOException;
import javacard.framework.Util;

public final class UserService {
    private static final byte FIRSTNAME_MAX_LENGTH = (byte) 25;
    private static final byte LASTNAME_MAX_LENGTH = (byte) 25;
    private static final byte EMAIL_MAX_LENGTH = (byte) 50;
    private static final byte PHONE_MAX_LENGTH = (byte) 25;
    private static final short PHOTO_MAX_LENGTH = (short) 5120; //1221; //16384; // 128x128

    private static final byte[] _photoSample = { 82,73,70,70,40,19,0,0,87,69,66,80,86,80,56,88,10,0,0,0,36,0,0,0,(byte)255,0,0,83,1,0,73,67,67,80,24,2,0,0,0,0,2,24,97,112,112,108,4,0,0,0,109,110,116,114,82,71,66,32,88,89,90,32,7,(byte)230,0,1,0,1,0,0,0,0,0,0,97,99,115,112,65,80,80,76,0,0,0,0,65,80,80,76,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(byte)246,(byte)214,0,1,0,0,0,0,(byte)211,45,97,112,112,108,(byte)236,(byte)253,(byte)163,(byte)142,56,(byte)133,71,(byte)195,109,(byte)180,(byte)189,79,122,(byte)218,24,47,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,100,101,115,99,0,0,0,(byte)252,0,0,0,48,99,112,114,116,0,0,1,44,0,0,0,80,119,116,112,116,0,0,1,124,0,0,0,20,114,88,89,90,0,0,1,(byte)144,0,0,0,20,103,88,89,90,0,0,1,(byte)164,0,0,0,20,98,88,89,90,0,0,1,(byte)184,0,0,0,20,114,84,82,67,0,0,1,(byte)204,0,0,0,32,99,104,97,100,0,0,1,(byte)236,0,0,0,44,98,84,82,67,0,0,1,(byte)204,0,0,0,32,103,84,82,67,0,0,1,(byte)204,0,0,0,32,109,108,117,99,0,0,0,0,0,0,0,1,0,0,0,12,101,110,85,83,0,0,0,20,0,0,0,28,0,68,0,105,0,115,0,112,0,108,0,97,0,121,0,32,0,80,0,51,109,108,117,99,0,0,0,0,0,0,0,1,0,0,0,12,101,110,85,83,0,0,0,52,0,0,0,28,0,67,0,111,0,112,0,121,0,114,0,105,0,103,0,104,0,116,0,32,0,65,0,112,0,112,0,108,0,101,0,32,0,73,0,110,0,99,0,46,0,44,0,32,0,50,0,48,0,50,0,50,88,89,90,32,0,0,0,0,0,0,(byte)246,(byte)213,0,1,0,0,0,0,(byte)211,44,88,89,90,32,0,0,0,0,0,0,(byte)131,(byte)223,0,0,61,(byte)191,(byte)255,(byte)255,(byte)255,(byte)187,88,89,90,32,0,0,0,0,0,0,74,(byte)191,0,0,(byte)177,55,0,0,10,(byte)185,88,89,90,32,0,0,0,0,0,0,40,56,0,0,17,11,0,0,(byte)200,(byte)185,112,97,114,97,0,0,0,0,0,3,0,0,0,2,102,102,0,0,(byte)242,(byte)167,0,0,13,89,0,0,19,(byte)208,0,0,10,91,115,102,51,50,0,0,0,0,0,1,12,66,0,0,5,(byte)222,(byte)255,(byte)255,(byte)243,38,0,0,7,(byte)147,0,0,(byte)253,(byte)144,(byte)255,(byte)255,(byte)251,(byte)162,(byte)255,(byte)255,(byte)253,(byte)163,0,0,3,(byte)220,0,0,(byte)192,110,86,80,56,32,8,11,0,0,(byte)176,102,0,(byte)157,1,42,0,1,84,1,63,1,122,(byte)182,85,43,39,(byte)171,40,(byte)163,(byte)242,74,(byte)201,96,32,9,103,110,(byte)224,1,117,(byte)255,(byte)175,58,0,(byte)187,(byte)156,(byte)136,(byte)196,(byte)224,(byte)253,(byte)180,75,(byte)162,4,(byte)134,110,91,30,(byte)233,29,(byte)133,(byte)194,(byte)236,(byte)203,(byte)196,21,117,(byte)175,34,(byte)133,(byte)148,(byte)217,(byte)168,32,118,67,(byte)222,26,(byte)217,107,2,48,95,108,(byte)148,(byte)228,10,(byte)234,66,(byte)242,(byte)174,(byte)208,19,126,(byte)173,70,13,(byte)209,(byte)214,92,(byte)201,10,(byte)128,(byte)145,43,(byte)133,105,112,(byte)237,34,82,90,(byte)141,109,(byte)227,(byte)137,(byte)184,28,22,12,123,(byte)140,(byte)225,(byte)175,104,(byte)200,(byte)189,(byte)184,75,47,(byte)248,47,(byte)179,(byte)136,(byte)232,(byte)235,3,85,76,88,(byte)180,(byte)229,122,(byte)128,(byte)129,(byte)168,(byte)141,111,67,27,(byte)228,16,30,(byte)217,(byte)253,40,(byte)165,0,52,36,103,(byte)135,83,(byte)167,49,33,(byte)160,123,37,46,77,(byte)156,(byte)137,(byte)140,(byte)136,49,97,119,(byte)226,(byte)130,30,(byte)244,66,54,120,10,(byte)194,8,23,(byte)136,(byte)187,(byte)219,41,(byte)245,(byte)254,37,30,(byte)201,16,(byte)137,26,(byte)164,(byte)149,60,(byte)166,(byte)132,(byte)144,54,46,0,(byte)174,108,(byte)221,122,18,(byte)151,24,36,37,(byte)129,57,65,122,15,(byte)128,(byte)184,105,113,(byte)227,(byte)135,85,(byte)207,(byte)147,54,33,(byte)180,113,(byte)217,32,2,(byte)175,48,(byte)180,(byte)158,10,4,(byte)173,41,(byte)237,(byte)196,32,91,115,(byte)140,(byte)181,(byte)221,(byte)132,(byte)136,(byte)178,6,100,(byte)154,(byte)188,50,(byte)153,64,106,(byte)231,(byte)156,86,51,(byte)158,87,54,3,(byte)213,106,(byte)231,46,82,(byte)210,(byte)169,15,5,103,105,(byte)255,(byte)188,(byte)151,(byte)187,(byte)236,(byte)213,(byte)184,65,(byte)150,(byte)189,(byte)170,8,(byte)214,93,(byte)162,(byte)195,(byte)231,(byte)149,116,(byte)157,9,42,(byte)204,92,39,48,(byte)227,(byte)162,85,93,103,(byte)129,(byte)235,117,(byte)226,33,52,(byte)230,29,(byte)147,53,(byte)133,(byte)186,(byte)155,35,(byte)238,91,9,87,81,31,(byte)207,20,(byte)208,124,65,95,(byte)131,83,(byte)252,6,21,(byte)252,(byte)157,(byte)202,124,(byte)189,58,32,125,(byte)200,(byte)186,76,36,(byte)198,115,(byte)206,93,(byte)179,38,68,(byte)185,(byte)233,126,(byte)145,(byte)170,28,(byte)207,(byte)143,(byte)224,19,(byte)173,71,(byte)255,68,127,42,39,1,(byte)191,34,(byte)211,81,(byte)179,48,99,(byte)206,(byte)253,(byte)176,66,97,(byte)139,(byte)138,(byte)242,(byte)209,37,(byte)191,(byte)233,85,26,(byte)234,(byte)181,(byte)244,(byte)145,73,105,77,51,16,(byte)186,127,(byte)198,(byte)253,0,38,(byte)147,125,(byte)238,9,111,(byte)146,70,110,105,92,66,31,(byte)195,69,(byte)196,(byte)240,110,39,115,59,112,(byte)136,48,(byte)185,(byte)248,(byte)203,7,(byte)137,(byte)141,(byte)206,51,(byte)186,127,119,(byte)131,58,(byte)146,71,(byte)231,56,(byte)206,102,(byte)249,46,(byte)219,(byte)193,113,(byte)231,(byte)143,100,(byte)235,(byte)210,62,(byte)142,(byte)157,31,57,20,31,16,(byte)184,97,91,(byte)142,102,(byte)234,(byte)202,(byte)199,27,(byte)196,62,12,43,(byte)197,(byte)177,51,37,(byte)196,87,29,(byte)150,63,(byte)202,(byte)169,100,15,(byte)151,(byte)231,23,30,(byte)131,24,106,(byte)143,108,1,44,62,52,115,3,108,(byte)217,(byte)174,118,(byte)241,(byte)193,121,(byte)237,(byte)243,(byte)147,119,39,119,62,(byte)155,(byte)158,122,(byte)210,(byte)205,(byte)139,(byte)139,53,1,6,14,(byte)215,119,(byte)176,107,16,(byte)168,9,51,6,(byte)253,(byte)167,73,92,(byte)199,(byte)220,34,(byte)255,(byte)252,123,123,59,(byte)252,(byte)194,(byte)141,6,24,(byte)141,(byte)133,103,4,24,22,13,20,(byte)233,(byte)210,(byte)140,(byte)203,(byte)167,(byte)141,(byte)215,(byte)161,44,86,(byte)168,(byte)201,31,(byte)241,125,(byte)248,75,(byte)219,83,(byte)212,(byte)129,(byte)142,124,10,(byte)177,(byte)129,(byte)179,(byte)148,(byte)169,(byte)177,(byte)220,(byte)188,(byte)189,24,109,(byte)162,123,(byte)128,16,79,(byte)166,(byte)200,10,67,(byte)132,48,(byte)146,14,86,87,(byte)147,86,91,(byte)180,32,50,(byte)151,(byte)209,51,22,(byte)137,(byte)130,(byte)170,(byte)207,(byte)203,30,(byte)186,(byte)231,95,122,93,85,(byte)235,(byte)204,(byte)175,(byte)166,(byte)188,(byte)159,(byte)151,17,(byte)218,57,93,28,(byte)239,65,(byte)166,70,76,(byte)202,(byte)249,(byte)137,7,(byte)213,5,75,(byte)225,62,53,28,(byte)143,105,8,59,(byte)148,(byte)176,63,(byte)209,(byte)156,67,(byte)157,9,66,23,63,53,66,63,17,23,87,30,33,54,(byte)138,13,(byte)224,74,(byte)178,(byte)183,(byte)155,(byte)252,127,(byte)183,(byte)183,(byte)223,86,83,(byte)218,(byte)137,90,77,70,78,(byte)144,(byte)158,96,82,(byte)221,114,22,108,(byte)243,62,(byte)222,83,16,(byte)250,26,(byte)174,(byte)183,90,(byte)250,(byte)177,116,83,(byte)162,(byte)239,15,7,(byte)184,114,19,111,10,45,17,(byte)230,8,117,(byte)159,(byte)242,4,29,105,(byte)144,(byte)161,107,8,(byte)254,75,115,29,98,(byte)139,(byte)227,(byte)185,121,83,(byte)224,(byte)177,(byte)177,(byte)238,67,87,9,68,51,(byte)228,5,(byte)145,8,42,19,82,(byte)221,67,(byte)169,(byte)203,(byte)221,(byte)161,(byte)160,5,(byte)237,37,100,(byte)180,(byte)173,(byte)130,109,4,111,49,71,62,(byte)160,(byte)231,(byte)206,51,9,124,93,(byte)227,(byte)151,18,120,64,(byte)177,51,25,74,(byte)221,(byte)176,(byte)231,(byte)197,(byte)157,(byte)156,0,0,(byte)254,(byte)231,(byte)181,(byte)130,106,(byte)228,75,(byte)195,15,113,92,121,(byte)223,(byte)143,127,71,(byte)209,(byte)207,(byte)151,29,87,(byte)190,(byte)223,(byte)147,89,(byte)147,15,118,125,(byte)143,28,121,(byte)159,(byte)217,(byte)249,(byte)165,(byte)217,55,23,60,(byte)129,(byte)175,10,(byte)207,(byte)147,119,(byte)137,0,2,(byte)181,21,(byte)185,21,(byte)172,0,18,(byte)133,79,(byte)242,17,(byte)166,(byte)234,2,(byte)130,100,(byte)187,(byte)241,(byte)162,(byte)201,63,(byte)182,(byte)193,(byte)242,(byte)129,(byte)178,(byte)240,(byte)233,(byte)227,(byte)241,16,38,19,(byte)155,(byte)160,48,(byte)170,(byte)206,(byte)235,54,(byte)178,(byte)222,43,(byte)247,(byte)160,(byte)141,(byte)193,125,(byte)223,(byte)253,(byte)142,(byte)163,(byte)166,(byte)158,(byte)179,48,121,(byte)211,56,8,(byte)134,2,(byte)240,(byte)247,67,(byte)141,116,(byte)224,(byte)158,60,92,107,(byte)166,(byte)160,(byte)235,(byte)183,(byte)217,(byte)154,(byte)207,(byte)175,108,23,(byte)194,(byte)254,20,80,(byte)163,(byte)137,(byte)188,57,9,(byte)174,23,(byte)244,(byte)205,(byte)199,82,27,(byte)143,(byte)224,23,66,(byte)218,(byte)206,62,(byte)169,(byte)146,6,40,(byte)242,(byte)135,(byte)135,76,40,(byte)228,77,123,(byte)128,74,(byte)252,(byte)245,111,(byte)206,(byte)241,(byte)177,(byte)170,(byte)196,103,3,114,75,85,(byte)219,71,90,113,(byte)176,(byte)155,(byte)194,67,(byte)179,55,127,(byte)156,(byte)150,(byte)186,(byte)194,(byte)185,47,(byte)131,49,120,(byte)185,(byte)231,29,46,(byte)224,49,(byte)205,66,90,(byte)201,(byte)184,51,74,0,65,44,51,(byte)169,(byte)157,(byte)243,80,(byte)219,4,76,(byte)240,(byte)255,47,11,(byte)222,36,5,(byte)240,(byte)181,85,(byte)150,89,105,(byte)207,16,52,91,(byte)212,126,(byte)248,(byte)208,(byte)223,(byte)218,25,(byte)151,(byte)229,(byte)228,118,(byte)173,(byte)253,92,6,52,45,6,14,77,(byte)246,(byte)168,(byte)159,88,(byte)146,31,(byte)175,(byte)195,48,25,93,82,(byte)252,33,(byte)160,100,127,20,(byte)181,(byte)128,(byte)221,28,20,69,(byte)231,(byte)137,(byte)208,3,(byte)132,58,(byte)187,(byte)173,(byte)187,(byte)156,11,(byte)166,43,8,14,86,66,(byte)191,104,(byte)244,124,39,62,(byte)144,(byte)195,(byte)215,65,13,(byte)198,(byte)206,(byte)192,26,101,(byte)252,(byte)157,(byte)203,77,24,119,49,20,17,107,(byte)178,10,48,118,35,(byte)141,40,11,(byte)184,84,(byte)232,121,30,(byte)186,(byte)152,(byte)214,125,11,(byte)235,(byte)183,102,(byte)248,(byte)242,(byte)152,97,83,15,(byte)235,(byte)185,(byte)191,(byte)247,(byte)199,(byte)255,11,(byte)254,(byte)133,96,92,4,43,82,92,(byte)145,24,37,(byte)244,(byte)157,(byte)247,123,124,(byte)238,(byte)200,(byte)206,(byte)145,33,(byte)231,70,40,56,(byte)169,(byte)139,80,85,16,(byte)142,(byte)235,20,(byte)178,35,98,(byte)174,(byte)203,(byte)132,(byte)209,53,83,(byte)159,66,9,106,45,60,(byte)206,81,(byte)183,(byte)200,(byte)153,45,96,(byte)129,122,70,(byte)215,(byte)144,24,0,(byte)248,(byte)133,(byte)208,56,113,106,(byte)157,116,(byte)143,(byte)156,(byte)172,26,68,(byte)146,(byte)166,(byte)206,(byte)158,98,(byte)153,(byte)192,(byte)149,3,(byte)225,(byte)198,(byte)183,6,70,95,64,(byte)146,82,37,(byte)138,(byte)200,(byte)239,(byte)160,106,(byte)252,70,26,(byte)133,88,65,73,89,(byte)236,(byte)208,(byte)228,(byte)180,(byte)130,104,61,123,(byte)161,65,123,(byte)138,66,3,(byte)210,(byte)226,(byte)238,62,4,(byte)139,91,121,(byte)188,87,(byte)172,(byte)158,(byte)189,3,87,(byte)154,43,127,(byte)250,(byte)159,32,(byte)251,(byte)149,120,21,1,21,77,(byte)137,(byte)180,97,101,100,(byte)246,(byte)174,76,94,91,35,72,71,(byte)159,76,17,45,(byte)138,(byte)190,69,(byte)227,99,(byte)155,(byte)158,52,(byte)191,28,38,(byte)235,34,(byte)255,(byte)177,(byte)151,115,(byte)253,34,70,30,105,(byte)129,113,9,(byte)229,127,(byte)210,15,31,6,(byte)174,119,18,(byte)172,(byte)142,(byte)253,(byte)154,(byte)236,(byte)188,101,(byte)202,48,(byte)162,46,(byte)209,76,93,63,73,(byte)170,(byte)155,77,31,13,(byte)212,71,66,79,(byte)181,117,(byte)218,(byte)225,(byte)235,(byte)170,(byte)232,108,119,47,55,82,(byte)232,(byte)170,92,45,108,(byte)161,(byte)129,20,(byte)211,(byte)244,(byte)138,(byte)212,49,(byte)171,6,(byte)143,(byte)154,60,(byte)133,119,(byte)231,(byte)136,(byte)155,(byte)253,(byte)247,30,33,(byte)235,70,3,60,28,(byte)239,46,(byte)185,(byte)132,75,(byte)217,(byte)167,(byte)159,66,(byte)161,108,17,41,(byte)150,(byte)178,124,(byte)219,(byte)244,(byte)232,76,(byte)229,114,8,(byte)198,(byte)242,(byte)131,(byte)180,(byte)250,110,(byte)224,(byte)166,(byte)130,(byte)248,71,(byte)219,(byte)222,17,(byte)195,(byte)154,(byte)195,(byte)151,66,31,(byte)202,(byte)214,78,(byte)226,(byte)179,(byte)238,(byte)132,(byte)201,(byte)247,123,119,(byte)176,(byte)128,(byte)225,35,(byte)168,7,(byte)152,102,(byte)138,(byte)155,(byte)224,4,(byte)223,68,(byte)151,91,(byte)201,(byte)144,8,114,(byte)140,111,16,75,(byte)184,(byte)185,(byte)237,78,(byte)172,115,(byte)217,65,(byte)233,12,(byte)156,25,(byte)147,52,9,76,124,1,(byte)215,(byte)170,(byte)238,(byte)238,94,92,(byte)191,(byte)174,(byte)197,63,104,(byte)213,(byte)190,(byte)190,(byte)188,54,(byte)166,(byte)175,(byte)203,36,(byte)166,(byte)209,(byte)187,58,24,(byte)247,(byte)130,81,(byte)218,47,58,(byte)171,(byte)148,102,43,(byte)195,46,(byte)150,(byte)216,21,89,(byte)131,(byte)210,(byte)163,(byte)229,52,91,(byte)131,35,(byte)218,9,(byte)237,68,(byte)187,(byte)165,(byte)237,(byte)178,(byte)153,(byte)232,23,(byte)148,(byte)243,123,(byte)129,84,53,48,48,120,(byte)130,51,(byte)133,81,(byte)229,106,48,(byte)226,(byte)167,71,90,7,(byte)188,63,(byte)245,7,(byte)213,(byte)213,80,(byte)135,(byte)138,66,127,(byte)157,(byte)135,62,(byte)162,(byte)162,8,86,102,38,(byte)220,82,39,14,1,(byte)128,19,(byte)244,109,28,(byte)253,16,10,(byte)178,3,99,41,2,(byte)133,(byte)210,84,107,88,(byte)168,12,(byte)129,117,(byte)132,(byte)139,37,(byte)254,3,28,(byte)137,(byte)200,(byte)145,37,52,(byte)179,15,127,108,61,38,(byte)158,80,(byte)208,117,(byte)235,45,70,(byte)220,(byte)155,(byte)160,19,56,(byte)161,(byte)160,(byte)135,84,16,48,63,92,(byte)209,(byte)156,111,74,(byte)141,66,103,20,(byte)233,115,10,(byte)177,(byte)175,(byte)200,(byte)233,(byte)173,37,(byte)157,(byte)159,64,14,(byte)173,(byte)185,(byte)154,(byte)141,(byte)245,(byte)239,(byte)218,(byte)252,(byte)247,(byte)242,(byte)184,(byte)209,(byte)129,(byte)134,31,(byte)136,(byte)151,113,6,41,33,30,(byte)158,(byte)170,(byte)223,(byte)231,(byte)212,59,(byte)196,(byte)222,100,106,(byte)200,(byte)171,(byte)208,(byte)213,25,112,(byte)164,(byte)138,98,72,(byte)145,(byte)207,41,(byte)191,64,(byte)193,(byte)144,57,61,(byte)219,(byte)133,(byte)133,(byte)238,40,7,41,(byte)196,(byte)129,38,63,2,44,(byte)156,(byte)223,3,(byte)140,(byte)130,76,(byte)208,(byte)233,71,(byte)200,13,110,40,(byte)186,91,37,(byte)148,117,(byte)232,(byte)216,39,(byte)167,(byte)174,108,(byte)169,(byte)210,121,(byte)224,(byte)212,18,83,(byte)219,30,85,8,107,(byte)200,71,50,(byte)244,(byte)205,(byte)206,18,(byte)208,(byte)150,(byte)161,47,(byte)195,(byte)159,127,(byte)202,(byte)165,(byte)202,(byte)183,(byte)172,(byte)225,(byte)130,(byte)215,74,95,(byte)212,(byte)156,(byte)150,104,48,80,(byte)156,(byte)212,93,30,41,(byte)162,115,57,7,(byte)172,(byte)152,(byte)195,(byte)200,60,99,(byte)130,(byte)251,(byte)209,(byte)225,(byte)191,108,(byte)159,(byte)164,118,7,(byte)231,24,104,(byte)231,73,(byte)190,(byte)133,(byte)208,91,(byte)128,110,(byte)218,(byte)248,39,(byte)146,52,107,(byte)170,48,127,5,(byte)221,67,101,(byte)234,(byte)247,(byte)252,(byte)187,99,17,11,120,(byte)248,(byte)150,73,89,82,(byte)172,66,(byte)230,(byte)219,7,(byte)192,36,(byte)161,(byte)141,40,(byte)161,30,51,93,5,44,118,(byte)227,98,50,93,(byte)189,50,122,20,95,(byte)221,114,(byte)153,65,(byte)234,14,(byte)141,(byte)144,(byte)199,(byte)207,(byte)145,(byte)237,(byte)243,(byte)192,39,(byte)136,(byte)245,(byte)240,(byte)197,110,(byte)149,93,16,101,(byte)197,87,40,122,25,(byte)144,32,17,31,(byte)157,(byte)245,25,(byte)248,(byte)154,15,(byte)139,13,104,(byte)157,(byte)192,(byte)145,(byte)178,(byte)186,(byte)150,114,47,71,(byte)154,(byte)203,(byte)148,21,92,103,26,(byte)166,42,(byte)144,106,(byte)215,(byte)201,78,(byte)144,(byte)172,(byte)183,48,102,93,(byte)185,62,86,38,110,71,78,47,(byte)177,40,(byte)217,(byte)182,126,63,(byte)162,(byte)150,(byte)176,(byte)202,(byte)131,(byte)254,18,(byte)157,18,(byte)168,98,(byte)173,(byte)173,63,(byte)163,64,(byte)207,90,25,(byte)178,(byte)255,42,90,(byte)191,(byte)254,(byte)197,(byte)130,(byte)245,43,59,(byte)192,(byte)192,21,79,(byte)192,(byte)198,(byte)171,58,(byte)183,72,(byte)154,(byte)178,(byte)176,0,(byte)191,(byte)141,(byte)132,55,(byte)142,(byte)193,(byte)145,119,110,(byte)210,19,(byte)154,93,(byte)205,(byte)201,39,94,14,(byte)152,92,(byte)132,10,(byte)182,124,(byte)232,(byte)224,100,21,67,56,28,(byte)225,(byte)158,(byte)135,54,(byte)234,121,(byte)233,(byte)211,(byte)250,103,(byte)246,(byte)218,110,5,37,22,(byte)198,(byte)248,(byte)241,(byte)195,(byte)197,26,(byte)170,(byte)212,54,102,43,42,(byte)159,50,69,(byte)238,(byte)217,(byte)155,(byte)150,(byte)236,110,(byte)240,(byte)158,86,(byte)227,(byte)224,(byte)232,4,69,(byte)213,8,(byte)176,14,(byte)137,(byte)250,(byte)163,31,71,(byte)236,37,(byte)246,(byte)224,58,66,(byte)214,(byte)177,(byte)188,(byte)231,(byte)218,(byte)214,18,61,92,41,(byte)218,(byte)239,(byte)171,(byte)206,86,(byte)231,(byte)248,32,108,(byte)208,(byte)190,(byte)166,(byte)226,(byte)235,113,77,(byte)253,(byte)148,75,26,(byte)234,(byte)178,(byte)130,31,(byte)192,(byte)182,(byte)226,49,60,42,(byte)205,31,127,123,(byte)236,(byte)211,9,4,(byte)153,(byte)196,2,(byte)137,(byte)143,14,(byte)203,(byte)187,84,(byte)208,(byte)245,108,(byte)190,(byte)246,18,(byte)193,(byte)129,33,102,(byte)246,75,(byte)211,102,(byte)196,(byte)190,94,18,(byte)242,96,75,(byte)190,(byte)172,(byte)195,98,(byte)241,7,(byte)155,(byte)194,34,57,90,(byte)250,(byte)232,106,(byte)189,107,37,55,30,113,112,(byte)163,(byte)222,(byte)165,22,120,58,(byte)181,23,125,40,76,(byte)159,(byte)128,78,(byte)164,25,21,116,(byte)212,(byte)163,0,(byte)182,(byte)181,(byte)186,(byte)172,19,74,89,(byte)157,69,(byte)156,99,(byte)220,(byte)171,116,112,42,125,(byte)241,(byte)205,90,(byte)248,77,(byte)255,90,113,102,54,107,(byte)208,120,(byte)251,115,63,58,38,46,31,66,79,(byte)204,(byte)195,(byte)173,37,88,71,81,32,(byte)164,115,65,75,51,(byte)202,(byte)133,17,116,108,(byte)211,(byte)248,(byte)156,(byte)166,30,105,(byte)159,127,(byte)230,95,45,12,9,27,80,(byte)171,48,21,(byte)156,(byte)182,(byte)249,105,(byte)188,108,(byte)164,(byte)243,4,89,48,(byte)164,108,(byte)144,113,(byte)189,(byte)238,(byte)167,73,117,2,84,(byte)220,24,50,(byte)136,(byte)139,(byte)141,(byte)194,(byte)164,(byte)163,(byte)231,(byte)164,109,(byte)204,52,96,115,(byte)198,(byte)194,2,65,(byte)229,22,(byte)247,7,124,3,(byte)216,(byte)196,(byte)208,25,(byte)147,(byte)165,(byte)222,(byte)241,82,(byte)187,51,33,52,87,(byte)239,(byte)214,28,108,79,46,72,54,35,(byte)141,30,19,(byte)219,68,93,55,115,48,90,(byte)140,(byte)204,(byte)243,(byte)234,(byte)253,(byte)224,(byte)235,3,25,25,75,(byte)197,(byte)238,(byte)250,(byte)201,(byte)147,(byte)187,(byte)222,(byte)132,(byte)234,87,82,80,(byte)196,(byte)241,55,(byte)193,(byte)253,115,109,(byte)183,(byte)173,67,(byte)140,56,23,(byte)223,(byte)255,(byte)209,81,(byte)246,77,(byte)176,(byte)146,64,(byte)154,(byte)155,(byte)164,(byte)195,117,85,120,126,11,(byte)172,(byte)236,36,22,105,(byte)242,(byte)196,53,(byte)163,(byte)154,(byte)240,(byte)208,0,51,(byte)186,(byte)219,(byte)129,109,112,105,(byte)134,42,102,(byte)149,(byte)232,10,47,(byte)188,(byte)203,64,68,5,86,87,19,88,68,(byte)215,(byte)202,62,(byte)156,96,0,71,(byte)255,(byte)196,(byte)137,(byte)135,17,24,111,48,6,(byte)130,75,(byte)128,120,(byte)193,(byte)175,82,(byte)253,(byte)132,(byte)162,(byte)242,(byte)129,(byte)229,77,(byte)205,(byte)179,25,119,(byte)174,(byte)176,79,10,(byte)173,(byte)131,(byte)188,(byte)211,124,78,(byte)236,(byte)145,(byte)128,(byte)146,127,53,89,92,64,(byte)129,53,20,58,(byte)128,38,54,(byte)172,104,(byte)253,(byte)199,118,1,26,49,(byte)237,40,(byte)181,(byte)130,(byte)134,27,97,(byte)229,60,(byte)186,(byte)166,(byte)151,(byte)234,(byte)217,22,63,113,(byte)138,41,(byte)132,53,52,(byte)197,(byte)232,77,73,51,2,(byte)233,102,(byte)248,(byte)215,(byte)251,30,64,14,(byte)129,127,(byte)214,3,(byte)156,64,(byte)239,(byte)181,(byte)198,(byte)155,92,42,(byte)208,97,54,(byte)243,37,(byte)225,(byte)144,(byte)154,91,(byte)247,72,116,(byte)211,87,50,(byte)195,114,7,(byte)231,(byte)246,91,61,(byte)143,(byte)174,(byte)210,93,(byte)141,47,(byte)222,117,124,(byte)224,(byte)191,(byte)168,41,(byte)207,(byte)156,(byte)173,82,38,(byte)140,(byte)200,(byte)134,26,77,(byte)168,42,(byte)180,27,(byte)162,11,(byte)161,(byte)145,(byte)198,(byte)240,(byte)253,(byte)165,113,(byte)234,(byte)185,(byte)233,(byte)177,27,4,36,(byte)137,(byte)208,(byte)137,(byte)243,(byte)231,49,120,2,(byte)149,99,22,(byte)167,28,79,4,8,56,(byte)166,104,18,(byte)250,118,(byte)178,(byte)153,66,46,58,(byte)130,71,55,6,43,(byte)185,44,89,87,64,(byte)175,0,(byte)212,0,121,79,112,47,(byte)208,(byte)230,(byte)230,59,(byte)254,61,(byte)244,39,(byte)184,50,(byte)182,(byte)254,(byte)171,(byte)188,25,120,(byte)141,77,(byte)170,101,(byte)167,116,(byte)236,(byte)233,(byte)237,18,67,32,0,27,21,88,(byte)197,(byte)188,(byte)155,(byte)245,74,(byte)179,106,39,(byte)219,16,41,(byte)232,(byte)179,(byte)220,80,0,88,77,80,32,(byte)218,5,0,0,60,120,58,120,109,112,109,101,116,97,32,120,109,108,110,115,58,120,61,34,97,100,111,98,101,58,110,115,58,109,101,116,97,47,34,32,120,58,120,109,112,116,107,61,34,88,77,80,32,67,111,114,101,32,54,46,48,46,48,34,62,10,32,32,32,60,114,100,102,58,82,68,70,32,120,109,108,110,115,58,114,100,102,61,34,104,116,116,112,58,47,47,119,119,119,46,119,51,46,111,114,103,47,49,57,57,57,47,48,50,47,50,50,45,114,100,102,45,115,121,110,116,97,120,45,110,115,35,34,62,10,32,32,32,32,32,32,60,114,100,102,58,68,101,115,99,114,105,112,116,105,111,110,32,114,100,102,58,97,98,111,117,116,61,34,34,10,32,32,32,32,32,32,32,32,32,32,32,32,120,109,108,110,115,58,101,120,105,102,61,34,104,116,116,112,58,47,47,110,115,46,97,100,111,98,101,46,99,111,109,47,101,120,105,102,47,49,46,48,47,34,10,32,32,32,32,32,32,32,32,32,32,32,32,120,109,108,110,115,58,120,109,112,61,34,104,116,116,112,58,47,47,110,115,46,97,100,111,98,101,46,99,111,109,47,120,97,112,47,49,46,48,47,34,10,32,32,32,32,32,32,32,32,32,32,32,32,120,109,108,110,115,58,116,105,102,102,61,34,104,116,116,112,58,47,47,110,115,46,97,100,111,98,101,46,99,111,109,47,116,105,102,102,47,49,46,48,47,34,10,32,32,32,32,32,32,32,32,32,32,32,32,120,109,108,110,115,58,112,104,111,116,111,115,104,111,112,61,34,104,116,116,112,58,47,47,110,115,46,97,100,111,98,101,46,99,111,109,47,112,104,111,116,111,115,104,111,112,47,49,46,48,47,34,62,10,32,32,32,32,32,32,32,32,32,60,101,120,105,102,58,83,117,98,115,101,99,84,105,109,101,68,105,103,105,116,105,122,101,100,62,48,48,48,60,47,101,120,105,102,58,83,117,98,115,101,99,84,105,109,101,68,105,103,105,116,105,122,101,100,62,10,32,32,32,32,32,32,32,32,32,60,101,120,105,102,58,83,117,98,115,101,99,84,105,109,101,62,48,48,48,60,47,101,120,105,102,58,83,117,98,115,101,99,84,105,109,101,62,10,32,32,32,32,32,32,32,32,32,60,101,120,105,102,58,80,105,120,101,108,88,68,105,109,101,110,115,105,111,110,62,50,53,54,60,47,101,120,105,102,58,80,105,120,101,108,88,68,105,109,101,110,115,105,111,110,62,10,32,32,32,32,32,32,32,32,32,60,101,120,105,102,58,79,102,102,115,101,116,84,105,109,101,68,105,103,105,116,105,122,101,100,62,43,48,49,58,48,48,60,47,101,120,105,102,58,79,102,102,115,101,116,84,105,109,101,68,105,103,105,116,105,122,101,100,62,10,32,32,32,32,32,32,32,32,32,60,101,120,105,102,58,80,105,120,101,108,89,68,105,109,101,110,115,105,111,110,62,51,52,48,60,47,101,120,105,102,58,80,105,120,101,108,89,68,105,109,101,110,115,105,111,110,62,10,32,32,32,32,32,32,32,32,32,60,101,120,105,102,58,79,102,102,115,101,116,84,105,109,101,62,43,48,49,58,48,48,60,47,101,120,105,102,58,79,102,102,115,101,116,84,105,109,101,62,10,32,32,32,32,32,32,32,32,32,60,101,120,105,102,58,79,102,102,115,101,116,84,105,109,101,79,114,105,103,105,110,97,108,62,43,48,49,58,48,48,60,47,101,120,105,102,58,79,102,102,115,101,116,84,105,109,101,79,114,105,103,105,110,97,108,62,10,32,32,32,32,32,32,32,32,32,60,101,120,105,102,58,83,117,98,115,101,99,84,105,109,101,79,114,105,103,105,110,97,108,62,48,48,48,60,47,101,120,105,102,58,83,117,98,115,101,99,84,105,109,101,79,114,105,103,105,110,97,108,62,10,32,32,32,32,32,32,32,32,32,60,120,109,112,58,77,111,100,105,102,121,68,97,116,101,62,50,48,49,57,45,49,49,45,49,56,84,48,56,58,49,57,58,53,50,46,48,48,48,60,47,120,109,112,58,77,111,100,105,102,121,68,97,116,101,62,10,32,32,32,32,32,32,32,32,32,60,120,109,112,58,67,114,101,97,116,101,68,97,116,101,62,50,48,49,57,45,49,49,45,49,56,84,48,56,58,49,57,58,53,50,46,48,48,48,60,47,120,109,112,58,67,114,101,97,116,101,68,97,116,101,62,10,32,32,32,32,32,32,32,32,32,60,120,109,112,58,77,101,116,97,100,97,116,97,68,97,116,101,62,50,48,50,50,45,49,48,45,49,48,84,49,53,58,50,48,58,49,53,43,48,50,58,48,48,60,47,120,109,112,58,77,101,116,97,100,97,116,97,68,97,116,101,62,10,32,32,32,32,32,32,32,32,32,60,120,109,112,58,67,114,101,97,116,111,114,84,111,111,108,62,80,105,120,101,108,109,97,116,111,114,32,80,114,111,32,51,46,48,60,47,120,109,112,58,67,114,101,97,116,111,114,84,111,111,108,62,10,32,32,32,32,32,32,32,32,32,60,116,105,102,102,58,82,101,115,111,108,117,116,105,111,110,85,110,105,116,62,50,60,47,116,105,102,102,58,82,101,115,111,108,117,116,105,111,110,85,110,105,116,62,10,32,32,32,32,32,32,32,32,32,60,116,105,102,102,58,79,114,105,101,110,116,97,116,105,111,110,62,49,60,47,116,105,102,102,58,79,114,105,101,110,116,97,116,105,111,110,62,10,32,32,32,32,32,32,32,32,32,60,116,105,102,102,58,88,82,101,115,111,108,117,116,105,111,110,62,50,49,54,48,48,48,48,47,49,48,48,48,48,60,47,116,105,102,102,58,88,82,101,115,111,108,117,116,105,111,110,62,10,32,32,32,32,32,32,32,32,32,60,116,105,102,102,58,89,82,101,115,111,108,117,116,105,111,110,62,50,49,54,48,48,48,48,47,49,48,48,48,48,60,47,116,105,102,102,58,89,82,101,115,111,108,117,116,105,111,110,62,10,32,32,32,32,32,32,32,32,32,60,112,104,111,116,111,115,104,111,112,58,68,97,116,101,67,114,101,97,116,101,100,62,50,48,49,57,45,49,49,45,49,56,84,48,56,58,49,57,58,53,50,46,48,48,48,60,47,112,104,111,116,111,115,104,111,112,58,68,97,116,101,67,114,101,97,116,101,100,62,10,32,32,32,32,32,32,60,47,114,100,102,58,68,101,115,99,114,105,112,116,105,111,110,62,10,32,32,32,60,47,114,100,102,58,82,68,70,62,10,60,47,120,58,120,109,112,109,101,116,97,62,10 };

    private final byte[] _firstName = new byte[FIRSTNAME_MAX_LENGTH];
    private final byte[] _surName = new byte[LASTNAME_MAX_LENGTH];
    private final byte[] _email = new byte[EMAIL_MAX_LENGTH];
    private final byte[] _phone = new byte[PHONE_MAX_LENGTH];
    private final byte[] _photo = new byte[PHOTO_MAX_LENGTH];
    private short _photoLength = 0;

    public UserService() {
        seedTestData();
    }

    public void getFirstName(APDU apdu) {
        ApduUtils.sendDataToCAD(apdu, _firstName, FIRSTNAME_MAX_LENGTH);
    }

    public void getLastName(APDU apdu) {
        ApduUtils.sendDataToCAD(apdu, _surName, LASTNAME_MAX_LENGTH);
    }

    public void getEmail(APDU apdu) {
        ApduUtils.sendDataToCAD(apdu, _email, EMAIL_MAX_LENGTH);
    }

    public void getPhone(APDU apdu) {
        ApduUtils.sendDataToCAD(apdu, _phone, PHONE_MAX_LENGTH);
    }

    public void getPhoto(APDU apdu) throws ISOException {
        ApduUtils._dataSource = _photo;
        ApduUtils._bytesLeft = _photoLength;
        ApduUtils._bytesOffset = 0;

        short dataLength = _photoLength > ApduContants.MAX_LE_VALUE ? Constants.S_FF : _photoLength;

        ISOException.throwIt((short)(ISO7816.SW_BYTES_REMAINING_00 | dataLength));
    }

    private void seedTestData() {
        byte[] firstName = {'D', 'm', 'i', 't', 'r', 'y'};
        byte[] surName = {'K', 'a', 'l', 'i', 'n', 'i', 'n'};
        byte[] email = {'D', 'm', 'i', 't', 'r', 'y', 'K', 'a', 'l', 'i', 'n', 'i', 'n', '@', 'i', 'c', 'l', 'o', 'u', 'd', '.', 'c', 'o', 'm'};
        byte[] phone = {'+', '4', '7', '4', '1', '5', '1', '0', '5', '7', '9'};

        Util.arrayCopyNonAtomic(firstName, Constants.S_0, _firstName, Constants.S_0, (short) firstName.length);
        Util.arrayCopyNonAtomic(surName, Constants.S_0, _surName, Constants.S_0, (short) surName.length);
        Util.arrayCopyNonAtomic(email, Constants.S_0, _email, Constants.S_0, (short) email.length);
        Util.arrayCopyNonAtomic(phone, Constants.S_0, _phone, Constants.S_0, (short) phone.length);

        _photoLength = (short) _photoSample.length;
        Util.arrayCopyNonAtomic(_photoSample, Constants.S_0, _photo, Constants.S_0, _photoLength);
    }
}
